Kapitel 3

Wie Monero funktioniert

Die ersten beiden Kapitel behandelten alles, was Sie über WARUM zur Verwendung von Monero (Kapitel 1) und WIE zur Verwendung von Monero (Kapitel 2) wissen müssen. Inzwischen haben Sie alles Notwendige gelernt, um Monero selbst zu verwenden!

Der Rest dieses Buches enthält zusätzliche Details, für diejenigen, die tiefer in die Funktionsweise von Monero "hinter den Kulissen" eintauchen möchten. Die Kapitel 3 und 4 beschreiben zugrunde liegende Technologien wie die Datenschutzfunktionen von Monero, die Blockchain und den Mining-Prozess - und konzentrieren sich auf das Verständnis der Konzepte, ohne in die fortgeschrittene Mathematik abzuweichen. Spätere Kapitel enthalten diese kniffligen Details für Entwickler und Kryptografie-Geeks.

3.1 Transaktion und das Ledger

Um die Voraussetzungen für das Verständnis der Datenschutztechnologien von Monero zu schaffen, werden wir prüfen, wie moneroj auf dem Ledger gesendet und empfangen wird. In diesem Kapitel konzentrieren wir uns auf die Blockchain-Funktionalität - ihre Rolle als inhärent manipulationssichere gemeinsame Datenbank, die eine Liste von Monero-Transaktionen führt. Die Details über Blockchain-Sicherheit (Mining, Hashes, etc.) sind ein weiteres Thema, reserviert für Kapitel 4.

Wenn Sie eine Brieftasche zum ersten Mal einrichten, generiert es einen neuen Samen, den Sie geheim halten und verwenden, um auf Ihr Moneroj auf der Blockchain zuzugreifen. Dieser Initialisierungsprozess wird auf Ihrem Gerät durchgeführt und kann vollständig offline ausgeführt werden. während der Erstellung von Brieftaschen wird nichts an das Netzwerk übertragen oder aufgezeichnet.

Hinter den Kulissen berechnet Ihre Wallet zwei Sätze von Schlüsseln aus Ihrem Seed. Ihre privaten Schlüssel sind ein streng gehütetes Geheimnis, da Sie sie verwenden, um Ihre Identität zu beweisen und auf Ihr Moneroj zuzugreifen. Ihre öffentlichen Schlüssel werden, wie der Name schon sagt, anderen Monero-Nutzern bekannt gemacht. Öffentliche und private Schlüssel werden zusammen als Sets generiert, mit besonderen mathematischen Eigenschaften, die eine spezielle Verbindung zwischen den Schlüsseln herstellen.

Um Moneroj zu empfangen, geben Sie Ihre Adresse (die aus Ihren öffentlichen Schlüsseln erstellt wurde) an den Absender weiter. Wenn Ihnen jemand (ein Kunde, eine Börse oder ein Freund) Monero schickt, sendet er eine Transaktion, die einen Teil seiner Moneroj in einen neuen Eintrag im Ledger überträgt, den Sie (und nur Sie) mit Ihren privaten Schlüsseln freischalten können.

Im Fachjargon wird die Ausgabe ihrer Transaktion auf der Blockchain gespeichert, damit Sie darauf zugreifen und sie mit Ihren privaten Schlüsseln ausgeben können, wenn Sie möchten. Diese Terminologie kann ein wenig verwirrend sein, da die Kryptowährung Verwendung des Wortes "Ausgabe" hat eine andere Bedeutung als seine typische Definition.

Jedes Mal, wenn Sie moneroj erhalten, gewinnen Sie einen weiteren Output; jedes Mal, wenn Sie moneroj ausgeben, verbrauchen Sie einen Ihrer Outputs und generieren einen neuen für jemand anderen. In der Tat sind alle Moneroj, die Sie "besitzen", einfach Ausgaben auf der Blockchain, die Ihre privaten Schlüssel freischalten. Solange Ihnen niemand Moneroj schickt, gibt es keine Outputs auf der Blockchain, die mit Ihren privaten Schlüsseln verbunden oder für diese zugänglich sind.

Wenn Ihre Wallet scannt oder synchronisiert, bedeutet dies in der Regel, dass sie Ihre privaten Schlüssel verwendet, um alle Transaktionen und Ausgaben auf der Blockchain zu überprüfen und relevante Einträge zu identifizieren. Ihr Wallet-Guthaben ist die Gesamtsumme dieser Ausgaben, die Ihre privaten Schlüssel freischalten und ausgeben können.

Wenn Sie Moneroj aus Ihrer Wallet senden, verbrauchen Sie einen Teil Ihrer Outputs als Input für eine Transaktion, die Sie an das Netzwerk senden. Konzeptionell ist die Blockchain einfach eine Aufzeichnung dieser Transaktionen, die jeweils die Outputs des Senders als Inputs verbrauchen, um einen neuen Output für den Empfänger zu erzeugen.

Der oben beschriebene Prozess ist leicht vereinfacht, um die entscheidenden Teile (private/öffentliche Schlüssel, Transaktionen, Inputs/Outputs) zu vermitteln. Die folgenden Abschnitte bieten nicht-technische Erklärungen der Schlüsselkonzepte, die Moneros Reihe von Datenschutzfunktionen zugrunde liegen.

3.2 Überblick über die Datenschutztechnologie

Die allgemeinen Prinzipien und die oben eingeführte Terminologie werden von den meisten Kryptowährungen geteilt. Monero bietet erweiterte Funktionalität und Privatsphäre durch mehrere einzigartige kryptographische Technologien, die die Benutzer und ihre Aktivitäten vor der Öffentlichkeit abschirmen. Abbildung 3.1 zeigt, wie diese komplementären Funktionen zusammenarbeiten, um sensible Transaktionsdetails zu schützen:

RingCT verbirgt den Transaktionsbetrag.
Ring-Signaturen schützen den Absender, indem sie verschleiern, welche Ausgabe getätigt wurde.
Stealth-Adressen stellen sicher, dass die Adresse des Empfängers nicht in der Blockchain aufgezeichnet wird.
Kovri unterbricht die Verbindung zwischen Ihren Transaktionen und dem physischen Standort, indem es den Übertragungsursprung verschleiert und Netzwerkspuren von Monero-Aktivitäten verdeckt.

![image](https://raw.githubusercontent.com/monerobook/monerobook/master/resources/img/mm-c03i01%20monero%20tech.png)

3.2.1 Ring Confidential Transaction

RingCT ist eine kryptografische Technologie, die die Menge an Moneroj, die in jeder Transaktion gesendet wird, verbirgt. Bei den meisten Kryptowährungen werden die Transaktionsbeträge im Klartext gesendet, sichtbar für jeden Beobachter. RingCT hält diese sensible Information privat, indem es dem Sender erlaubt, zu beweisen, dass er genug Moneroj für eine Transaktion hat, ohne den Wert dieses Betrages preiszugeben! Dies ist dank kryptographischer Zusagen und Range Proofs möglich.

Wenn Sie Moneroj senden, "verpflichten" Sie den Betrag auf eine private Art und Weise, indem Sie gerade genug Informationen preisgeben, damit das Netzwerk die Legitimität der Transaktion bestätigen kann, während der Betrag selbst nicht öffentlich bekannt gegeben wird. Ein gültiges Commitment garantiert, dass die Transaktion nicht in betrügerischer Absicht erstellt oder zu viel Moneroj ausgegeben wurde.

Range Proofs sind ein weiterer wichtiger Mechanismus in RingCT, als eine Methode, um sicherzustellen, dass der zugesagte Betrag größer als Null und kleiner als eine bestimmte Zahl ist. Dies ist notwendig, um zu verhindern, dass Absender negative oder unmöglich hohe Beträge an Moneroj zusagen. Zusammen sichern Commitments und Range Proofs das Angebot von Moneroj gegen betrügerische Manipulationen und Fälschungsversuche.

Vor RingCT wurden Monero-Transaktionen in bestimmte Stückelungen aufgeteilt (zum Beispiel würden 12,5 XMR als 10 XMR + 2 XMR + 0,5 XMR gesendet) und die Transaktionsbeträge waren für außenstehende Beobachter sichtbar. RingCT wurde im Januar 2017 aktiviert, und es folgte sofort eine rasche, weit verbreitete Akzeptanz. Innerhalb von 1 Monat nach der Aktivierung nutzten bereits ca. 98% der neuen Transaktionen freiwillig das RingCT-Protokoll!

Im Einklang mit Moneros Politik der erzwungenen Privacy-by-Default, wurde RingCT für alle Monero-Transaktionen nach September 2017 obligatorisch. Um alte Prä-RingCT-Ausgaben auszugeben, müssen diese zunächst in RingCT-Ausgaben mit maskierten Beträgen umgewandelt werden.

3.2.2 Stealth (einmalige) Adressen

Alle Monero-Transaktionen verwenden Stealth-Adressen, um die Privatsphäre des Empfängers zu schützen. Um zu vermeiden, dass die Wallet-Adresse des Empfängers auf der Blockchain aufgezeichnet wird, wird jede Monero-Transaktion stattdessen an eine einmalige Einwegadresse gesendet. Der Empfänger kann auf Gelder zugreifen, die an eine Stealth-Adresse gesendet werden, ohne dass Links zu den öffentlichen Adressen seiner Wallet oder anderen Transaktionen offengelegt werden.

![image](https://raw.githubusercontent.com/monerobook/monerobook/master/resources/img/mm-c03i04%20stealth%20address.png)

Um die Verwendung von zufälligen Einmalcodes zum Schutz der Identität des Empfängers zu konzipieren, stellen Sie sich vor, dass Sie Ihrem Freund André ein paar Bücher über den Umgang mit einer empfindlichen Krankheit schenken möchten. Leider sind Sie gerade dabei, die Stadt für eine Reise zu verlassen, und André wird erst nächste Woche wieder da sein. Vielleicht könnten Sie Ihren freundlichen Nachbarn bitten, die Bücher vorübergehend aufzubewahren und sie an den Empfänger weiterzugeben.

Ihr Nachbar wird sich vergewissern müssen, dass jeder, der die Bücher in Anspruch nehmen möchte, auch tatsächlich der vorgesehene Empfänger ist. Da es sich bei Ihrem Freund um eine Privatperson mit einem sensiblen Zustand handelt, wäre es unangebracht, Ihrem Nachbarn zu sagen, er solle seinen Ausweis auf den Namen "André" überprüfen. Wie könnten Sie den Austausch arrangieren und dabei Andrés Privatsphäre bewahren? Sie könnten sich einfach einen einmaligen Zufallscode ausdenken und Ihrem Nachbarn sagen, dass er die Bücher demjenigen geben soll, der diesen Code präsentiert (z. B. geben Sie diese Bücher der Person, die den Ausdruck "PolarComboTango357" kennt). Ihr Nachbar kann dann die Bücher verfolgen und sie André geben, ohne etwas über den Empfänger zu erfahren.

Ähnlich wie Sie diesen zufälligen, nicht-informativen Code verwenden, um Ihren Nachbarn davon abzuhalten, etwas über den Empfänger Ihrer Bücher zu erfahren, verwendet Monero ein System von Einmal-Codes, um zu verhindern, dass das Netzwerk etwas über Monero-Empfänger erfährt! Anstatt die Adresse des Empfängers explizit auf der Blockchain zu vermerken (analog: "Gib die Bücher André"), werden die Gelder immer an eine einmalige "Stealth-Adresse" gesendet (analog: "Gib diese Bücher der Person, die den Ausdruck PolarComboTango357 kennt"). Die kryptografischen Techniken, die Stealth-Adressen ausschließlich für den Empfänger sichern, werden in Kapitel 5 besprochen, die wichtigsten Punkte sind jedoch im Folgenden aufgeführt.

Wie werden diese einmaligen Adressen generiert? Die öffentlichen Adressen Ihrer Monero-Wallet sind 95-Zeichen-Strings, die zwei öffentliche Schlüssel (den öffentlichen Ansichts- und den öffentlichen Ausgabenschlüssel) enthalten, die mathematisch von Ihrem Seed abgeleitet sind. Wenn Ihnen jemand Geld schickt, verwendet er die öffentlichen Schlüssel in Ihrer Adresse zusammen mit einigen zufälligen Daten, um einen einzigartigen einmaligen öffentlichen Schlüssel zu generieren. Diese einmaligen öffentlichen Schlüssel, die in Transaktionen auf der Blockchain aufgezeichnet werden, werden Stealth-Adressen genannt, weil es für das Netzwerk oder einen außenstehenden Beobachter unmöglich ist, diese zufälligen Codes mit den ursprünglichen Wallets zu verbinden.

![image](https://raw.githubusercontent.com/monerobook/monerobook/master/resources/img/mm-c03i02%20donation.png)

Beachten Sie, dass Subadressen nicht dasselbe sind wie Stealth-Adressen. Subadressen sind wiederverwendbare öffentliche Wallet-Adressen, die nicht in der Blockchain aufgezeichnet werden. Mehrere Transaktionen, die an eine einzige Subadresse gesendet werden, zeigen alle auf unterschiedliche und nicht verknüpfbare Stealth-Adressen.

Die verbesserte Privatsphäre durch die Nichtaufzeichnung von Wallet-Adressen in der Blockchain ist ein klarer Vorteil der Implementierung von Stealth-Adressen. Eine noch größere Auswirkung ist, dass die Verwendung dieser einzigartigen Einmalschlüssel verhindert, dass mehrere Zahlungen an dieselbe Adresse miteinander verknüpft werden!

Nehmen wir an, Sie erstellen ein öffentliches Kunstwerk und posten eine Adresse für Kryptowährungsspenden. Wenn Sie einen Coin mit einer transparenten Blockchain verwenden (z. B. Bitcoin), dann wird jede eingehende Transaktion an diese Adresse permanent in durchsuchbarer, verknüpfbarer Form aufgezeichnet. Jeder kann einen Blockchain-Explorer verwenden, um zu sehen, wie viele Bitcoin-Spenden Sie erhalten haben, deren Betrag und ob Sie die Gelder verschoben haben oder nicht. Jede eingehende Bitcoin-Transaktion wird im Ledger durch die Adresse indiziert, die Sie öffentlich geteilt haben.

Wenn Sie stattdessen eine Monero-Adresse posten, sind Ihre Spenden nicht öffentlich einsehbar. Jeder Spender generiert eine eindeutige, einmalige Stealth-Adresse und zeichnet diese im Ledger auf. Die öffentliche Spendenadresse, die Sie neben Ihrem Projekt gepostet haben, wird nie direkt in einer Transaktion referenziert, und die Stealth-Adressen geben keine Informationen über den Empfänger preis. Da jeder Spender seine eigenen zufälligen Informationen untermischt, um die Stealth-Adresse für seine Transaktion zu erstellen, kann ein Spender eine von einem anderen generierte Stealth-Adresse nicht erkennen. Alle Monero-Transaktionen müssen Stealth-Adressen verwenden, um die Privatsphäre des gesamten Netzwerks zu gewährleisten. Ihre Wallet erstellt die Stealth-Adresse automatisch aus der öffentlichen Adresse, wenn sie die Transaktion generiert.

3.2.3 Ring-Signaturen

Ring-Signaturen sind eine Funktion von Monero, die dazu dient, den Absender einer Transaktion zu schützen, indem die Quelle der ausgegebenen Moneroj verschleiert wird. Bevor wir uns mit Ring-Signaturen beschäftigen, werden wir das Konzept der digitalen Signaturen im Allgemeinen vorstellen.

Digitale Signaturen sind eine allgemeine kryptographische Methode, um die Authentizität und Quelle von Daten oder einer Nachricht zu bestätigen. Die Signaturen können gegen den öffentlichen Schlüssel geprüft werden, um die Identität des Unterzeichners zu bestätigen und um zu verifizieren, dass die signierte Nachricht vollständig und unverändert ist. Wenn die signierten Daten auch nur um ein einziges Zeichen verändert werden (sei es durch absichtliche Manipulation oder versehentliche Fehlkommunikation), wird die Signatur ungültig.

Unterschiedliche Implementierungen von digitalen Signaturen sind eine Schlüsselkomponente aller Kryptowährungen. Um eine Ausgabe zu tätigen, verfassen Sie eine Nachricht an das Netzwerk, in der Sie die Transaktion beschreiben, signieren diese mit Ihrem entsprechenden privaten Schlüssel und senden dann das Ergebnis an das Netzwerk. Bevor die Transaktion ausgeführt wird, überprüft das Netzwerk die Gültigkeit der Signatur, um sicherzustellen, dass die Nachricht nicht von einem Dritten, der nicht den richtigen privaten Schlüssel besitzt, verändert und/oder gefälscht wurde.

Bei transparenten Kryptowährungen (z. B. Bitcoin) wird in jeder Nachricht, die eine Transaktion beschreibt, explizit angegeben, welche Ausgaben getätigt werden. Dies ist nützlich für eine einfache Buchführung, da das Netzwerk einfach eine Aufzeichnung der nicht ausgegebenen Transaktionsausgaben (UTXOs) führt, die als gültige Eingaben für neue Transaktionen betrachtet werden. Wenn jemand versucht, denselben Bitcoin-Output zweimal auszugeben, wird die betrügerische zweite Transaktion sofort zurückgewiesen, da das Netzwerk weiß, dass der Besitzer diesen Output bereits ausgegeben hat (als er die erste Transaktion unterzeichnet und gesendet hat). Leider ist dieser einfache Eigentumsnachweis sehr nachteilig für die Privatsphäre, da er definitiv die Quelle der Gelder angibt und zeigt, wann eine bestimmte Ausgabe ausgegeben wurde.

Monero verwendet ein anderes Schema, bekannt als Ring-Signaturen. Diese Gruppensignatur-Methode erlaubt es einem Mitglied, die Nachricht im Namen der Gruppe digital zu signieren, während es die öffentlichen Schlüssel der anderen Mitglieder untermischt, so dass es unklar ist, wer die Nachricht aktiv signiert hat. Es ist möglich, kryptographisch zu verifizieren, dass eines der Ringmitglieder die Nachricht signiert hat, aber es ist unmöglich, festzustellen, welches der Mitglieder die Signatur tatsächlich angefertigt hat.

Ring-Signaturen werden in Monero verwendet, um die Schlüssel von mehreren Ausgaben auf der Blockchain zu mischen, um zu verschleiern, welche Ausgabe tatsächlich ausgegeben wird. Nehmen wir an, Maria möchte eine ihrer Monero-Ausgaben ausgeben. Ihre Wallet wird halb zufällig mehrere andere vergangene Ausgaben auf der Blockchain auswählen (die nicht Maria gehören) und deren öffentliche Schlüssel als Köder in die Ringsignatur mischen. Das Netzwerk ist in der Lage zu verifizieren, dass einer der Outputs ausgegeben wird, jedoch sind die Decoys und der wahre Spender kryptographisch nicht unterscheidbar.

Ringsignaturen schützen den Absender bei allen Transaktionen, da der Empfänger und das Monero-Netzwerk nicht feststellen können, welches Ringmitglied die wahre Quelle der Gelder ist. Eine wichtige Konsequenz von Ringsignaturen ist, dass ein außenstehender Beobachter nicht definitiv beweisen kann, dass eine Ausgabe ausgegeben wurde! Die Tatsache, dass eine Ausgabe in einer Ringsignatur auftaucht, ist völlig unschlüssig, da es unmöglich ist, zu unterscheiden, ob sie wirklich ausgegeben wurde oder nur passiv als Lockvogel für ein Ringmitglied eingesetzt wurde.

Da es unmöglich ist, zu erkennen, ob ein bestimmter Ausgang ausgegeben wurde, fragen Sie sich vielleicht, was einen skrupellosen Benutzer daran hindert, denselben Ausgang zweimal auszugeben? Bei transparenten "One-Output-One-Spend"-Blockchains (z.B. Bitcoin) ist dies eine triviale Aufgabe: Jede Ausgabe, die einmal kryptographisch signiert und übertragen wurde, ist als ausgegeben markiert und kann nicht erneut verwendet werden. Monero-Ausgaben können jedoch in Ringsignaturen erscheinen, bevor und nachdem sie ausgegeben wurden, daher muss die Wiederverwendung von Ausgaben auf andere Weise verhindert werden.

Dies wird durch die Verwendung von Schlüsselbildern erreicht, die mit jeder Transaktion generiert und aufgezeichnet werden und eindeutig von der tatsächlich ausgegebenen Ausgabe abgeleitet sind. Das Netzwerk kann nicht feststellen, welches Ringmitglied mit dem Schlüsselbild verbunden ist; andere Teilnehmer müssen nur prüfen, ob das Schlüsselbild schon einmal verwendet wurde oder nicht. Wenn ein böswilliger Benutzer versucht, dieselbe Ausgabe zweimal auszugeben, erzeugt er beide Male dasselbe Schlüsselbild, und das Netzwerk weist die betrügerische zweite Transaktion sofort zurück. Dank der Schlüsselbilder kann das Netzwerk die Wiederverwendung von Ausgaben verhindern, obwohl es nicht weiß, welche Ausgaben ausgegeben wurden!





